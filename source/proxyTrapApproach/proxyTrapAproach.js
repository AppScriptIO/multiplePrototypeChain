"use strict";Object.defineProperty(exports, "__esModule", { value: true });exports.delegateToMultipleObject = delegateToMultipleObject;exports.inheritsMultipleConstructors = inheritsMultipleConstructors;exports.inheritsMultiple = inheritsMultiple;
function delegateToMultipleObject({ targetObject, delegationList, proxiedPrototypeType = 'object' }) {








  const proxyHandler = {

    get(target, key, receiver) {
      const parent = delegationList.find(p => Reflect.has(p, key));
      return parent ? Reflect.get(parent, key, receiver) : void 0;
    },

    has: (target, key) => delegationList.some(p => Reflect.has(p, key)),

    set(target, prop, value, receiver) {
      var obj = delegationList.find(obj => prop in obj);
      return Reflect.set(obj || Object.create(null), prop, value, receiver);
    },




    *enumerate(target) {
      yield* this.ownKeys(target);
    },

    ownKeys(target) {
      var hash = Object.create(null);
      for (var obj of delegationList) for (var p in obj) if (!hash[p]) hash[p] = true;
      return Object.getOwnPropertyNames(hash);
    },

    getOwnPropertyDescriptor(target, prop) {
      function getDesc(obj, prop) {
        var desc = Object.getOwnPropertyDescriptor(obj, prop);
        return desc || (obj = Object.getPrototypeOf(obj) ? getDesc(obj, prop) : void 0);
      }
      var obj = delegationList.find(obj => prop in obj);
      var desc = obj ? getDesc(obj, prop) : void 0;
      if (desc) desc.configurable = true;
      return desc;
    },

    preventExtensions: target => false,
    defineProperty: (target, prop, desc) => false };



  let proxyTarget;
  switch (proxiedPrototypeType) {
    case 'function':
      proxyTarget = new Function();
      break;
    case 'object':
    default:
      proxyTarget = Object.create(null);
      break;}

  let proxiedPrototype = new Proxy(proxyTarget, proxyHandler);

  Object.setPrototypeOf(targetObject, proxiedPrototype);
}


function inheritsMultipleConstructors({ BaseCtor, SuperCtors }) {
  return new Proxy(BaseCtor, {
    construct(_, [baseArgs = [], superArgs = []], newTarget) {
      let instance = {};

      instance = SuperCtors.reduce((acc, Ctor, i) => {
        const args = superArgs[i] || [];
        return Object.assign(acc, new Ctor(...args));
      }, instance);

      instance = Object.assign(instance, new BaseCtor(...baseArgs));

      Object.setPrototypeOf(instance, BaseCtor.prototype);
      return instance;
    } });

}


function inheritsMultiple({ BaseCtor, SuperCtors }) {
  delegateToMultipleObject({
    targetObject: BaseCtor.prototype,
    delegationList: SuperCtors.map(Ctor => Ctor.prototype) });


  return inheritsMultipleConstructors({ BaseCtor, SuperCtors });
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NvdXJjZS9wcm94eVRyYXBBcHByb2FjaC9wcm94eVRyYXBBcHJvYWNoLmpzIl0sIm5hbWVzIjpbImRlbGVnYXRlVG9NdWx0aXBsZU9iamVjdCIsInRhcmdldE9iamVjdCIsImRlbGVnYXRpb25MaXN0IiwicHJveGllZFByb3RvdHlwZVR5cGUiLCJwcm94eUhhbmRsZXIiLCJnZXQiLCJ0YXJnZXQiLCJrZXkiLCJyZWNlaXZlciIsInBhcmVudCIsImZpbmQiLCJwIiwiUmVmbGVjdCIsImhhcyIsInNvbWUiLCJzZXQiLCJwcm9wIiwidmFsdWUiLCJvYmoiLCJPYmplY3QiLCJjcmVhdGUiLCJlbnVtZXJhdGUiLCJvd25LZXlzIiwiaGFzaCIsImdldE93blByb3BlcnR5TmFtZXMiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJnZXREZXNjIiwiZGVzYyIsImdldFByb3RvdHlwZU9mIiwiY29uZmlndXJhYmxlIiwicHJldmVudEV4dGVuc2lvbnMiLCJkZWZpbmVQcm9wZXJ0eSIsInByb3h5VGFyZ2V0IiwiRnVuY3Rpb24iLCJwcm94aWVkUHJvdG90eXBlIiwiUHJveHkiLCJzZXRQcm90b3R5cGVPZiIsImluaGVyaXRzTXVsdGlwbGVDb25zdHJ1Y3RvcnMiLCJCYXNlQ3RvciIsIlN1cGVyQ3RvcnMiLCJjb25zdHJ1Y3QiLCJfIiwiYmFzZUFyZ3MiLCJzdXBlckFyZ3MiLCJuZXdUYXJnZXQiLCJpbnN0YW5jZSIsInJlZHVjZSIsImFjYyIsIkN0b3IiLCJpIiwiYXJncyIsImFzc2lnbiIsInByb3RvdHlwZSIsImluaGVyaXRzTXVsdGlwbGUiLCJtYXAiXSwibWFwcGluZ3MiOiI7QUFDTyxTQUFTQSx3QkFBVCxDQUFrQyxFQUFFQyxZQUFGLEVBQWdCQyxjQUFoQixFQUFnQ0Msb0JBQW9CLEdBQUcsUUFBdkQsRUFBbEMsRUFBcUc7Ozs7Ozs7OztBQVMxRyxRQUFNQyxZQUFZLEdBQUc7O0FBRW5CQyxJQUFBQSxHQUFHLENBQUNDLE1BQUQsRUFBU0MsR0FBVCxFQUFjQyxRQUFkLEVBQXdCO0FBQ3pCLFlBQU1DLE1BQU0sR0FBR1AsY0FBYyxDQUFDUSxJQUFmLENBQW9CQyxDQUFDLElBQUlDLE9BQU8sQ0FBQ0MsR0FBUixDQUFZRixDQUFaLEVBQWVKLEdBQWYsQ0FBekIsQ0FBZjtBQUNBLGFBQU9FLE1BQU0sR0FBR0csT0FBTyxDQUFDUCxHQUFSLENBQVlJLE1BQVosRUFBb0JGLEdBQXBCLEVBQXlCQyxRQUF6QixDQUFILEdBQXdDLEtBQUssQ0FBMUQ7QUFDRCxLQUxrQjs7QUFPbkJLLElBQUFBLEdBQUcsRUFBRSxDQUFDUCxNQUFELEVBQVNDLEdBQVQsS0FBaUJMLGNBQWMsQ0FBQ1ksSUFBZixDQUFvQkgsQ0FBQyxJQUFJQyxPQUFPLENBQUNDLEdBQVIsQ0FBWUYsQ0FBWixFQUFlSixHQUFmLENBQXpCLENBUEg7O0FBU25CUSxJQUFBQSxHQUFHLENBQUNULE1BQUQsRUFBU1UsSUFBVCxFQUFlQyxLQUFmLEVBQXNCVCxRQUF0QixFQUFnQztBQUNqQyxVQUFJVSxHQUFHLEdBQUdoQixjQUFjLENBQUNRLElBQWYsQ0FBb0JRLEdBQUcsSUFBSUYsSUFBSSxJQUFJRSxHQUFuQyxDQUFWO0FBQ0EsYUFBT04sT0FBTyxDQUFDRyxHQUFSLENBQVlHLEdBQUcsSUFBSUMsTUFBTSxDQUFDQyxNQUFQLENBQWMsSUFBZCxDQUFuQixFQUF3Q0osSUFBeEMsRUFBOENDLEtBQTlDLEVBQXFEVCxRQUFyRCxDQUFQO0FBQ0QsS0Faa0I7Ozs7O0FBaUJuQixLQUFDYSxTQUFELENBQVdmLE1BQVgsRUFBbUI7QUFDakIsYUFBTyxLQUFLZ0IsT0FBTCxDQUFhaEIsTUFBYixDQUFQO0FBQ0QsS0FuQmtCOztBQXFCbkJnQixJQUFBQSxPQUFPLENBQUNoQixNQUFELEVBQVM7QUFDZCxVQUFJaUIsSUFBSSxHQUFHSixNQUFNLENBQUNDLE1BQVAsQ0FBYyxJQUFkLENBQVg7QUFDQSxXQUFLLElBQUlGLEdBQVQsSUFBZ0JoQixjQUFoQixFQUFnQyxLQUFLLElBQUlTLENBQVQsSUFBY08sR0FBZCxFQUFtQixJQUFJLENBQUNLLElBQUksQ0FBQ1osQ0FBRCxDQUFULEVBQWNZLElBQUksQ0FBQ1osQ0FBRCxDQUFKLEdBQVUsSUFBVjtBQUNqRSxhQUFPUSxNQUFNLENBQUNLLG1CQUFQLENBQTJCRCxJQUEzQixDQUFQO0FBQ0QsS0F6QmtCOztBQTJCbkJFLElBQUFBLHdCQUF3QixDQUFDbkIsTUFBRCxFQUFTVSxJQUFULEVBQWU7QUFDckMsZUFBU1UsT0FBVCxDQUFpQlIsR0FBakIsRUFBc0JGLElBQXRCLEVBQTRCO0FBQzFCLFlBQUlXLElBQUksR0FBR1IsTUFBTSxDQUFDTSx3QkFBUCxDQUFnQ1AsR0FBaEMsRUFBcUNGLElBQXJDLENBQVg7QUFDQSxlQUFPVyxJQUFJLEtBQUtULEdBQUcsR0FBR0MsTUFBTSxDQUFDUyxjQUFQLENBQXNCVixHQUF0QixJQUE2QlEsT0FBTyxDQUFDUixHQUFELEVBQU1GLElBQU4sQ0FBcEMsR0FBa0QsS0FBSyxDQUFsRSxDQUFYO0FBQ0Q7QUFDRCxVQUFJRSxHQUFHLEdBQUdoQixjQUFjLENBQUNRLElBQWYsQ0FBb0JRLEdBQUcsSUFBSUYsSUFBSSxJQUFJRSxHQUFuQyxDQUFWO0FBQ0EsVUFBSVMsSUFBSSxHQUFHVCxHQUFHLEdBQUdRLE9BQU8sQ0FBQ1IsR0FBRCxFQUFNRixJQUFOLENBQVYsR0FBd0IsS0FBSyxDQUEzQztBQUNBLFVBQUlXLElBQUosRUFBVUEsSUFBSSxDQUFDRSxZQUFMLEdBQW9CLElBQXBCO0FBQ1YsYUFBT0YsSUFBUDtBQUNELEtBcENrQjs7QUFzQ25CRyxJQUFBQSxpQkFBaUIsRUFBRXhCLE1BQU0sSUFBSSxLQXRDVjtBQXVDbkJ5QixJQUFBQSxjQUFjLEVBQUUsQ0FBQ3pCLE1BQUQsRUFBU1UsSUFBVCxFQUFlVyxJQUFmLEtBQXdCLEtBdkNyQixFQUFyQjs7OztBQTJDQSxNQUFJSyxXQUFKO0FBQ0EsVUFBUTdCLG9CQUFSO0FBQ0UsU0FBSyxVQUFMO0FBQ0U2QixNQUFBQSxXQUFXLEdBQUcsSUFBSUMsUUFBSixFQUFkO0FBQ0E7QUFDRixTQUFLLFFBQUw7QUFDQTtBQUNFRCxNQUFBQSxXQUFXLEdBQUdiLE1BQU0sQ0FBQ0MsTUFBUCxDQUFjLElBQWQsQ0FBZDtBQUNBLFlBUEo7O0FBU0EsTUFBSWMsZ0JBQWdCLEdBQUcsSUFBSUMsS0FBSixDQUFVSCxXQUFWLEVBQXVCNUIsWUFBdkIsQ0FBdkI7O0FBRUFlLEVBQUFBLE1BQU0sQ0FBQ2lCLGNBQVAsQ0FBc0JuQyxZQUF0QixFQUFvQ2lDLGdCQUFwQztBQUNEOzs7QUFHTSxTQUFTRyw0QkFBVCxDQUFzQyxFQUFFQyxRQUFGLEVBQVlDLFVBQVosRUFBdEMsRUFBZ0U7QUFDckUsU0FBTyxJQUFJSixLQUFKLENBQVVHLFFBQVYsRUFBb0I7QUFDekJFLElBQUFBLFNBQVMsQ0FBQ0MsQ0FBRCxFQUFJLENBQUNDLFFBQVEsR0FBRyxFQUFaLEVBQWdCQyxTQUFTLEdBQUcsRUFBNUIsQ0FBSixFQUFxQ0MsU0FBckMsRUFBZ0Q7QUFDdkQsVUFBSUMsUUFBUSxHQUFHLEVBQWY7O0FBRUFBLE1BQUFBLFFBQVEsR0FBR04sVUFBVSxDQUFDTyxNQUFYLENBQWtCLENBQUNDLEdBQUQsRUFBTUMsSUFBTixFQUFZQyxDQUFaLEtBQWtCO0FBQzdDLGNBQU1DLElBQUksR0FBR1AsU0FBUyxDQUFDTSxDQUFELENBQVQsSUFBZ0IsRUFBN0I7QUFDQSxlQUFPOUIsTUFBTSxDQUFDZ0MsTUFBUCxDQUFjSixHQUFkLEVBQW1CLElBQUlDLElBQUosQ0FBUyxHQUFHRSxJQUFaLENBQW5CLENBQVA7QUFDRCxPQUhVLEVBR1JMLFFBSFEsQ0FBWDs7QUFLQUEsTUFBQUEsUUFBUSxHQUFHMUIsTUFBTSxDQUFDZ0MsTUFBUCxDQUFjTixRQUFkLEVBQXdCLElBQUlQLFFBQUosQ0FBYSxHQUFHSSxRQUFoQixDQUF4QixDQUFYOztBQUVBdkIsTUFBQUEsTUFBTSxDQUFDaUIsY0FBUCxDQUFzQlMsUUFBdEIsRUFBZ0NQLFFBQVEsQ0FBQ2MsU0FBekM7QUFDQSxhQUFPUCxRQUFQO0FBQ0QsS0Fid0IsRUFBcEIsQ0FBUDs7QUFlRDs7O0FBR00sU0FBU1EsZ0JBQVQsQ0FBMEIsRUFBRWYsUUFBRixFQUFZQyxVQUFaLEVBQTFCLEVBQW9EO0FBQ3pEdkMsRUFBQUEsd0JBQXdCLENBQUM7QUFDdkJDLElBQUFBLFlBQVksRUFBRXFDLFFBQVEsQ0FBQ2MsU0FEQTtBQUV2QmxELElBQUFBLGNBQWMsRUFBRXFDLFVBQVUsQ0FBQ2UsR0FBWCxDQUFlTixJQUFJLElBQUlBLElBQUksQ0FBQ0ksU0FBNUIsQ0FGTyxFQUFELENBQXhCOzs7QUFLQSxTQUFPZiw0QkFBNEIsQ0FBQyxFQUFFQyxRQUFGLEVBQVlDLFVBQVosRUFBRCxDQUFuQztBQUNEIiwic291cmNlc0NvbnRlbnQiOlsiLyoqIFN1cHBvcnQgbXVsdGlwbGUgZGVsZWdhdGVkIHByb3RvdHlwZSBwcm9wZXJ0eSBsb29rdXAsIHdoZXJlIHRoZSB0YXJnZXQncyBwcm90b3R5cGUgaXMgb3ZlcndyaXR0ZW4gYnkgYSBwcm94eS4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkZWxlZ2F0ZVRvTXVsdGlwbGVPYmplY3QoeyB0YXJnZXRPYmplY3QsIGRlbGVnYXRpb25MaXN0LCBwcm94aWVkUHJvdG90eXBlVHlwZSA9ICdvYmplY3QnIH0pIHtcbiAgLyogICAgIFxuICBUaGVyZSBhcmUgbW9yZSB0cmFwcyBhdmFpbGFibGUsIHdoaWNoIGFyZSBub3QgdXNlZFxuICBUaGUgZ2V0UHJvdG90eXBlT2YgdHJhcCBjb3VsZCBiZSBhZGRlZCwgYnV0IHRoZXJlIGlzIG5vIHByb3BlciB3YXkgdG8gcmV0dXJuIHRoZSBtdWx0aXBsZSBwcm90b3R5cGVzLiBUaGlzIGltcGxpZXMgaW5zdGFuY2VvZiB3b24ndCB3b3JrIG5laXRoZXIuIFRoZXJlZm9yZSwgSSBsZXQgaXQgZ2V0IHRoZSBwcm90b3R5cGUgb2YgdGhlIHRhcmdldCwgd2hpY2ggaW5pdGlhbGx5IGlzIG51bGwuXG4gIFRoZSBzZXRQcm90b3R5cGVPZiB0cmFwIGNvdWxkIGJlIGFkZGVkIGFuZCBhY2NlcHQgYW4gYXJyYXkgb2Ygb2JqZWN0cywgd2hpY2ggd291bGQgcmVwbGFjZSB0aGUgcHJvdG90eXBlcy4gVGhpcyBpcyBsZWZ0IGFzIGFuIGV4ZXJjaWNlIGZvciB0aGUgcmVhZGVyLiBIZXJlIEkganVzdCBsZXQgaXQgbW9kaWZ5IHRoZSBwcm90b3R5cGUgb2YgdGhlIHRhcmdldCwgd2hpY2ggaXMgbm90IG11Y2ggdXNlZnVsIGJlY2F1c2Ugbm8gdHJhcCB1c2VzIHRoZSB0YXJnZXQuXG4gIFRoZSBkZWxldGVQcm9wZXJ0eSB0cmFwIGlzIGEgdHJhcCBmb3IgZGVsZXRpbmcgb3duIHByb3BlcnRpZXMuIFRoZSBwcm94eSByZXByZXNlbnRzIHRoZSBpbmhlcml0YW5jZSwgc28gdGhpcyB3b3VsZG4ndCBtYWtlIG11Y2ggc2Vuc2UuIEkgbGV0IGl0IGF0dGVtcHQgdGhlIGRlbGV0aW9uIG9uIHRoZSB0YXJnZXQsIHdoaWNoIHNob3VsZCBoYXZlIG5vIHByb3BlcnR5IGFueXdheS5cbiAgVGhlIGlzRXh0ZW5zaWJsZSB0cmFwIGlzIGEgdHJhcCBmb3IgZ2V0dGluZyB0aGUgZXh0ZW5zaWJpbGl0eS4gTm90IG11Y2ggdXNlZnVsLCBnaXZlbiB0aGF0IGFuIGludmFyaWFudCBmb3JjZXMgaXQgdG8gcmV0dXJuIHRoZSBzYW1lIGV4dGVuc2liaWxpdHkgYXMgdGhlIHRhcmdldC4gU28gSSBqdXN0IGxldCBpdCByZWRpcmVjdCB0aGUgb3BlcmF0aW9uIHRvIHRoZSB0YXJnZXQsIHdoaWNoIHdpbGwgYmUgZXh0ZW5zaWJsZS5cbiAgVGhlIGFwcGx5IGFuZCBjb25zdHJ1Y3QgdHJhcHMgYXJlIHRyYXBzIGZvciBjYWxsaW5nIG9yIGluc3RhbnRpYXRpbmcuIFRoZXkgYXJlIG9ubHkgdXNlZnVsIHdoZW4gdGhlIHRhcmdldCBpcyBhIGZ1bmN0aW9uIG9yIGEgY29uc3RydWN0b3IuXG4gICovXG4gIGNvbnN0IHByb3h5SGFuZGxlciA9IHtcbiAgICAvLyBUaGUgZ2V0IHRyYXAgaXMgYSB0cmFwIGZvciBnZXR0aW5nIHByb3BlcnR5IHZhbHVlcy4gSSB1c2UgZmluZCB0byBmaW5kIHRoZSBmaXJzdCBwcm90b3R5cGUgd2hpY2ggY29udGFpbnMgdGhhdCBwcm9wZXJ0eSwgYW5kIEkgcmV0dXJuIHRoZSB2YWx1ZSwgb3IgY2FsbCB0aGUgZ2V0dGVyIG9uIHRoZSBhcHByb3ByaWF0ZSByZWNlaXZlci4gVGhpcyBpcyBoYW5kbGVkIGJ5IFJlZmxlY3QuZ2V0LiBJZiBubyBwcm90b3R5cGUgY29udGFpbnMgdGhlIHByb3BlcnR5LCBJIHJldHVybiB1bmRlZmluZWQuXG4gICAgZ2V0KHRhcmdldCwga2V5LCByZWNlaXZlcikge1xuICAgICAgY29uc3QgcGFyZW50ID0gZGVsZWdhdGlvbkxpc3QuZmluZChwID0+IFJlZmxlY3QuaGFzKHAsIGtleSkpXG4gICAgICByZXR1cm4gcGFyZW50ID8gUmVmbGVjdC5nZXQocGFyZW50LCBrZXksIHJlY2VpdmVyKSA6IHZvaWQgMCAvLyBiZWNhdXNlIGB1bmRlZmluZWRgIGlzIGEgZ2xvYmFsIHZhcmlhYmxlIGFuZCBub3QgYSByZXNlcnZlZCB3b3JkIGluIEpTLiB2b2lkIHNpbXBseSBpbnN1cmVzIHRoZSByZXR1cm4gb2YgdW5kZWZpbmVkLlxuICAgIH0sXG4gICAgLy8gVGhlIGhhcyB0cmFwIGlzIGEgdHJhcCBmb3IgdGhlIGluIG9wZXJhdG9yLiBJIHVzZSBzb21lIHRvIGNoZWNrIGlmIGF0IGxlYXN0IG9uZSBwcm90b3R5cGUgY29udGFpbnMgdGhlIHByb3BlcnR5LlxuICAgIGhhczogKHRhcmdldCwga2V5KSA9PiBkZWxlZ2F0aW9uTGlzdC5zb21lKHAgPT4gUmVmbGVjdC5oYXMocCwga2V5KSksXG4gICAgLy8gVGhlIHNldCB0cmFwIGlzIGEgdHJhcCBmb3Igc2V0dGluZyBwcm9wZXJ0eSB2YWx1ZXMuIEkgdXNlIGZpbmQgdG8gZmluZCB0aGUgZmlyc3QgcHJvdG90eXBlIHdoaWNoIGNvbnRhaW5zIHRoYXQgcHJvcGVydHksIGFuZCBJIGNhbGwgaXRzIHNldHRlciBvbiB0aGUgYXBwcm9wcmlhdGUgcmVjZWl2ZXIuIElmIHRoZXJlIGlzIG5vIHNldHRlciBvciBubyBwcm90b3R5cGUgY29udGFpbnMgdGhlIHByb3BlcnR5LCB0aGUgdmFsdWUgaXMgZGVmaW5lZCBvbiB0aGUgYXBwcm9wcmlhdGUgcmVjZWl2ZXIuIFRoaXMgaXMgaGFuZGxlZCBieSBSZWZsZWN0LnNldC5cbiAgICBzZXQodGFyZ2V0LCBwcm9wLCB2YWx1ZSwgcmVjZWl2ZXIpIHtcbiAgICAgIHZhciBvYmogPSBkZWxlZ2F0aW9uTGlzdC5maW5kKG9iaiA9PiBwcm9wIGluIG9iailcbiAgICAgIHJldHVybiBSZWZsZWN0LnNldChvYmogfHwgT2JqZWN0LmNyZWF0ZShudWxsKSwgcHJvcCwgdmFsdWUsIHJlY2VpdmVyKVxuICAgIH0sXG4gICAgLyoqXG4gICAgICogVGhlIGVudW1lcmF0ZSB0cmFwIGlzIGEgdHJhcCBmb3IgZm9yLi4uaW4gbG9vcHMuIEkgaXRlcmF0ZSB0aGUgZW51bWVyYWJsZSBwcm9wZXJ0aWVzIGZyb20gdGhlIGZpcnN0IHByb3RvdHlwZSwgdGhlbiBmcm9tIHRoZSBzZWNvbmQsIGFuZCBzbyBvbi4gT25jZSBhIHByb3BlcnR5IGhhcyBiZWVuIGl0ZXJhdGVkLCBJIHN0b3JlIGl0IGluIGEgaGFzaCB0YWJsZSB0byBhdm9pZCBpdGVyYXRpbmcgaXQgYWdhaW4uXG4gICAgICogV2FybmluZzogVGhpcyB0cmFwIGhhcyBiZWVuIHJlbW92ZWQgaW4gRVM3IGRyYWZ0IGFuZCBpcyBkZXByZWNhdGVkIGluIGJyb3dzZXJzLlxuICAgICAqL1xuICAgICplbnVtZXJhdGUodGFyZ2V0KSB7XG4gICAgICB5aWVsZCogdGhpcy5vd25LZXlzKHRhcmdldClcbiAgICB9LFxuICAgIC8vIFRoZSBvd25LZXlzIHRyYXAgaXMgYSB0cmFwIGZvciBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcygpLiBTaW5jZSBFUzcsIGZvci4uLmluIGxvb3BzIGtlZXAgY2FsbGluZyBbW0dldFByb3RvdHlwZU9mXV0gYW5kIGdldHRpbmcgdGhlIG93biBwcm9wZXJ0aWVzIG9mIGVhY2ggb25lLiBTbyBpbiBvcmRlciB0byBtYWtlIGl0IGl0ZXJhdGUgdGhlIHByb3BlcnRpZXMgb2YgYWxsIHByb3RvdHlwZXMsIEkgdXNlIHRoaXMgdHJhcCB0byBtYWtlIGFsbCBlbnVtZXJhYmxlIGluaGVyaXRlZCBwcm9wZXJ0aWVzIGFwcGVhciBsaWtlIG93biBwcm9wZXJ0aWVzLlxuICAgIG93bktleXModGFyZ2V0KSB7XG4gICAgICB2YXIgaGFzaCA9IE9iamVjdC5jcmVhdGUobnVsbClcbiAgICAgIGZvciAodmFyIG9iaiBvZiBkZWxlZ2F0aW9uTGlzdCkgZm9yICh2YXIgcCBpbiBvYmopIGlmICghaGFzaFtwXSkgaGFzaFtwXSA9IHRydWVcbiAgICAgIHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhoYXNoKVxuICAgIH0sXG4gICAgLy8gVGhlIGdldE93blByb3BlcnR5RGVzY3JpcHRvciB0cmFwIGlzIGEgdHJhcCBmb3IgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcigpLiBNYWtpbmcgYWxsIGVudW1lcmFibGUgcHJvcGVydGllcyBhcHBlYXIgbGlrZSBvd24gcHJvcGVydGllcyBpbiB0aGUgb3duS2V5cyB0cmFwIGlzIG5vdCBlbm91Z2gsIGZvci4uLmluIGxvb3BzIHdpbGwgZ2V0IHRoZSBkZXNjcmlwdG9yIHRvIGNoZWNrIGlmIHRoZXkgYXJlIGVudW1lcmFibGUuIFNvIEkgdXNlIGZpbmQgdG8gZmluZCB0aGUgZmlyc3QgcHJvdG90eXBlIHdoaWNoIGNvbnRhaW5zIHRoYXQgcHJvcGVydHksIGFuZCBJIGl0ZXJhdGUgaXRzIHByb3RvdHlwaWNhbCBjaGFpbiB1bnRpbCBJIGZpbmQgdGhlIHByb3BlcnR5IG93bmVyLCBhbmQgSSByZXR1cm4gaXRzIGRlc2NyaXB0b3IuIElmIG5vIHByb3RvdHlwZSBjb250YWlucyB0aGUgcHJvcGVydHksIEkgcmV0dXJuIHVuZGVmaW5lZC4gVGhlIGRlc2NyaXB0b3IgaXMgbW9kaWZpZWQgdG8gbWFrZSBpdCBjb25maWd1cmFibGUsIG90aGVyd2lzZSB3ZSBjb3VsZCBicmVhayBzb21lIHByb3h5IGludmFyaWFudHMuXG4gICAgZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwgcHJvcCkge1xuICAgICAgZnVuY3Rpb24gZ2V0RGVzYyhvYmosIHByb3ApIHtcbiAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwgcHJvcClcbiAgICAgICAgcmV0dXJuIGRlc2MgfHwgKG9iaiA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmopID8gZ2V0RGVzYyhvYmosIHByb3ApIDogdm9pZCAwKVxuICAgICAgfVxuICAgICAgdmFyIG9iaiA9IGRlbGVnYXRpb25MaXN0LmZpbmQob2JqID0+IHByb3AgaW4gb2JqKVxuICAgICAgdmFyIGRlc2MgPSBvYmogPyBnZXREZXNjKG9iaiwgcHJvcCkgOiB2b2lkIDBcbiAgICAgIGlmIChkZXNjKSBkZXNjLmNvbmZpZ3VyYWJsZSA9IHRydWVcbiAgICAgIHJldHVybiBkZXNjXG4gICAgfSxcbiAgICAvLyBUaGUgcHJldmVudEV4dGVuc2lvbnMgYW5kIGRlZmluZVByb3BlcnR5IHRyYXBzIGFyZSBvbmx5IGluY2x1ZGVkIHRvIHByZXZlbnQgdGhlc2Ugb3BlcmF0aW9ucyBmcm9tIG1vZGlmeWluZyB0aGUgcHJveHkgdGFyZ2V0LiBPdGhlcndpc2Ugd2UgY291bGQgZW5kIHVwIGJyZWFraW5nIHNvbWUgcHJveHkgaW52YXJpYW50cy5cbiAgICBwcmV2ZW50RXh0ZW5zaW9uczogdGFyZ2V0ID0+IGZhbHNlLFxuICAgIGRlZmluZVByb3BlcnR5OiAodGFyZ2V0LCBwcm9wLCBkZXNjKSA9PiBmYWxzZSxcbiAgfVxuXG4gIC8vIGNyZWF0aW5nIGEgbmV3IG9iamVjdCBhbmQgdXNpbmcgaXQgZm9yIHRoZSBwcm94eSBpbnN0ZWFkIG9mIHRoZSB0YXJnZXQgb2JqZWN0LCBhbGxvd3MgZm9yIHNpbXBsaWZpZWQgaW1wbGVtZW50YXRpb24gb2YgdHJhcCBmdW5jdGlvbnMuXG4gIGxldCBwcm94eVRhcmdldFxuICBzd2l0Y2ggKHByb3hpZWRQcm90b3R5cGVUeXBlKSB7XG4gICAgY2FzZSAnZnVuY3Rpb24nOlxuICAgICAgcHJveHlUYXJnZXQgPSBuZXcgRnVuY3Rpb24oKVxuICAgICAgYnJlYWtcbiAgICBjYXNlICdvYmplY3QnOlxuICAgIGRlZmF1bHQ6XG4gICAgICBwcm94eVRhcmdldCA9IE9iamVjdC5jcmVhdGUobnVsbClcbiAgICAgIGJyZWFrXG4gIH1cbiAgbGV0IHByb3hpZWRQcm90b3R5cGUgPSBuZXcgUHJveHkocHJveHlUYXJnZXQsIHByb3h5SGFuZGxlcilcbiAgLy8gRGVsZWdhdGUgdG8gcHJveHkgdGhhdCB3aWxsIGhhbmRsZSBhbmQgcmVkaXJlY3QgZnVuZGFtZW50YWwgb3BlcmF0aW9ucyB0byB0aGUgYXBwcm9wcmlhdGUgb2JqZWN0LlxuICBPYmplY3Quc2V0UHJvdG90eXBlT2YodGFyZ2V0T2JqZWN0LCBwcm94aWVkUHJvdG90eXBlKVxufVxuXG4vLyBpbXBsZW1lbnQgbXVsdGlwbGUgc3VwZXIgY29uc3RydWN0b3JzIHdpdGggYWJpbGl0eSB0byBwYXNzIHVuaXF1ZSBhcmd1bWVudHMgZm9yIGVhY2ggZHVyaW5nIGluc3RhbmNlIGNyZWF0aW9uLlxuZXhwb3J0IGZ1bmN0aW9uIGluaGVyaXRzTXVsdGlwbGVDb25zdHJ1Y3RvcnMoeyBCYXNlQ3RvciwgU3VwZXJDdG9ycyB9KSB7XG4gIHJldHVybiBuZXcgUHJveHkoQmFzZUN0b3IsIHtcbiAgICBjb25zdHJ1Y3QoXywgW2Jhc2VBcmdzID0gW10sIHN1cGVyQXJncyA9IFtdXSwgbmV3VGFyZ2V0KSB7XG4gICAgICBsZXQgaW5zdGFuY2UgPSB7fVxuXG4gICAgICBpbnN0YW5jZSA9IFN1cGVyQ3RvcnMucmVkdWNlKChhY2MsIEN0b3IsIGkpID0+IHtcbiAgICAgICAgY29uc3QgYXJncyA9IHN1cGVyQXJnc1tpXSB8fCBbXVxuICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihhY2MsIG5ldyBDdG9yKC4uLmFyZ3MpKVxuICAgICAgfSwgaW5zdGFuY2UpXG5cbiAgICAgIGluc3RhbmNlID0gT2JqZWN0LmFzc2lnbihpbnN0YW5jZSwgbmV3IEJhc2VDdG9yKC4uLmJhc2VBcmdzKSlcblxuICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKGluc3RhbmNlLCBCYXNlQ3Rvci5wcm90b3R5cGUpXG4gICAgICByZXR1cm4gaW5zdGFuY2VcbiAgICB9LFxuICB9KVxufVxuXG4vLyBjcmVhdGUgZGVsZWdhdGlvbiBvbiBjb25zdHJ1Y3RvcnMgJiBwcm90b3R5cGVzLlxuZXhwb3J0IGZ1bmN0aW9uIGluaGVyaXRzTXVsdGlwbGUoeyBCYXNlQ3RvciwgU3VwZXJDdG9ycyB9KSB7XG4gIGRlbGVnYXRlVG9NdWx0aXBsZU9iamVjdCh7XG4gICAgdGFyZ2V0T2JqZWN0OiBCYXNlQ3Rvci5wcm90b3R5cGUsXG4gICAgZGVsZWdhdGlvbkxpc3Q6IFN1cGVyQ3RvcnMubWFwKEN0b3IgPT4gQ3Rvci5wcm90b3R5cGUpLFxuICB9KVxuXG4gIHJldHVybiBpbmhlcml0c011bHRpcGxlQ29uc3RydWN0b3JzKHsgQmFzZUN0b3IsIFN1cGVyQ3RvcnMgfSlcbn1cbiJdfQ==